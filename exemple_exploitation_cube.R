
###############################################################################
# Exemple minimal de création d'un cube avec distrr
library(distrr)
head(invented_wages, n = 8)

# On crée une liste d'appel à deux fonctions
liste_fonctions <- list(
  salaire_moyen = ~weighted.mean(wage, sample_weights),
  p50 = ~wq(wage, sample_weights)
)

# Et on l'utilise comme argument .funs_list dans la fonction dcc6
dcc6(.data = invented_wages,
     .variables = c("gender", "sector"),
     .funs_list = liste_fonctions
)
###############################################################################


###############################################################################
# Exemple d'exploitation d'un cube (graphiques)
library(dplyr)
library(ggplot2)
library(tidyr)

load("examples/cubi/RSS/c08C.rda")

str(c08C)

p01 <- ggplot(c08C, aes(x = anno, y = p50, size = N_etp))
p01 + geom_point(alpha = 0.5) + expand_limits(y = 0)


p03 <- ggplot(c08C, aes(x = p25, y = p75, size = N_etp, colour = sesso))
p03 + geom_point(alpha = 0.5) + expand_limits(x = 0, y = 0) +
  coord_equal() + scale_y_continuous(breaks = seq(0, 16000, by = 2000))
p03 + geom_point(alpha = 0.5) + expand_limits(x = 0, y = 0) +
  coord_equal() + scale_y_continuous(breaks = seq(0, 16000, by = 2000)) +
  facet_wrap(~sesso)
p03 + geom_point(alpha = 0.5) + expand_limits(x = 0, y = 0) +
  coord_equal() + scale_y_continuous(breaks = seq(0, 16000, by = 2000)) +
  facet_wrap(~formazione, nrow = 2)
###############################################################################




###############################################################################
# Convert the cube in long form with only one numeric column
c08C_long <- gather(data = c08C, key = "statistica", value = "valore", N_etp:p90)
c08C_long
###############################################################################